

اینها در ویو نوشته شده بودند   ###################################


from django.contrib import messages

class index(TemplateView):
    template_name = 'ticket/onepage.html'



def Newuser(request):
    if request.method == 'POST':
        first_name = request.POST['first_name']
        last_name = request.POST['last_name']
        phone_name = request.POST['phone_name']
        imail_name = request.POST['imail_name']
        password = request.POST['password']
        name(imail_name=imail_name , password=password , first_name=first_name , last_name=last_name , phone_name=phone_name ).save()

        messages.success(request, 'سلام' + request.POST['imail_name'] + 'به سایت ما خوش آمدید')
        return render(request,'ticket/login.html')
    else:
        return render(request, 'ticket/account.html')


def Loginuser(request):
    if request.method == 'POST':
        try:
            userdate = name.objects.get(imail_name=request.POST['imail_name'],password=request.POST['password'])
            print('username=',userdate)
            request.session['imail_name']=userdate.imail_name
            return render(request,'ticket/firstpage.html')
        except name.DoesNotExist:
            messages.error(request, 'نام کاربری یا رمز ورود اشتباه است  ' + request.POST['imail_name'] )

    return render(request, 'ticket/login.html')


def logoutuser(request):
    try:
        del request.session['imail_name']
    except:
        return render(request,'ticket/firstpage.html')
    return render(request,'ticket/onepage.html')



اینها در urls نوشته شده بودند ##################################

from ticket.views import index
from . import views

    path('first/janer/film/account/', views.Newuser , name='register'),
    path('first/janer/film/account/login/',views.Loginuser , name='login'),
    path('first/janer/film/account/logout/', views.logoutuser, name='logout'),
    path('',index.as_view()),



from ticket.views import loginview
from ticket.views import accountview

# path('first/janer/film/account/',accountview.as_view()),
# path('first/janer/film/account/login/',loginview.as_view() , name='login'),




اینها در ویو برای لاگین و ایجاد حساب کاربری بوده #######################################


class loginview(firstpageview):
    template_name = 'ticket/login.html'

    def get_context_data(self, *args, **kwargs):
        context = super(loginview, self).get_context_data(*args, **kwargs)
        # context['users'] = YourModel.objects.all()
        return context



class accountview(LoginRequiredMixin,TemplateView):
    template_name = 'ticket/account.html'

    def get_context_data(self, *args, **kwargs):
        context = super(accountview, self).get_context_data(*args, **kwargs)
        # context['users'] = YourModel.objects.all()
        return context
